export cmd_caller='eval echo 1>&2 $( caller )'

trace(){
echo 1>&2  "${@:-}"
}

exiting(){
local num=${1:-1}
echo 1>&2 "CALLER(2): $(caller 2)"
echo 1>&2 "CALLER(3): $(caller 3)"
trace "exiting $num"
exit $num
}

commander(){ 
local args=($@)
local cmd="${args[@]}"
trace  "[cmd] $cmd"
eval "$cmd" || { exiting 1; }
}
ensure(){ 
$cmd_caller
local args=($@)
local cmd="${args[@]}"
trace  "[ensure] $cmd"
eval "$cmd" || { exiting; }
}
cat1(){
local file=$1
test -f $file && { trace $file;trace '-----';cat 1>&2 -n  $file; trace; } || true
}

export -f exiting
export -f cat1
export -f ensure 
export -f commander 
export -f trace

